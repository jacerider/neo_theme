{"version":3,"file":"media.library.js","sources":["../../src/js/media.library.js"],"sourcesContent":["((Drupal, once) => {\n  Drupal.behaviors.neoMediaLibrary = {\n    attach: function attach() {\n      Drupal.neoMediaLibrary.init();\n    },\n  };\n\n  Drupal.neoMediaLibrary = {\n    init: function () {\n      once('media-library-select-all', '.js-media-library-view[data-view-display-id=\"page\"]').forEach(el => {\n        if (el.querySelectorAll('.js-media-library-item').length) {\n          const header = document.querySelector('.media-library-views-form');\n          const selectAll = document.createElement('label');\n          selectAll.className = 'media-library-select-all';\n          selectAll.innerHTML = Drupal.theme('checkbox') + Drupal.t('Select all media');\n          selectAll.children[0].addEventListener('click', e => {\n            const currentTarget = e.currentTarget;\n            const checkboxes = currentTarget\n              .closest('.js-media-library-view')\n              .querySelectorAll('.js-media-library-item .form-boolean');\n\n            checkboxes.forEach(checkbox => {\n              const stateChanged = checkbox.checked !== currentTarget.checked;\n\n              if (stateChanged) {\n                checkbox.checked = currentTarget.checked;\n                checkbox.dispatchEvent(new Event('change'));\n              }\n            });\n\n            const announcement = currentTarget.checked ? Drupal.t('All @count items selected', {\n              '@count': checkboxes.length\n            }) : Drupal.t('Zero items selected');\n            Drupal.announce(announcement);\n\n            this.bulkOperations();\n          });\n          header.prepend(selectAll);\n        }\n\n        this.itemSelect();\n      });\n    },\n\n    itemSelect: () => {\n      document.querySelectorAll('.media-library-view .js-click-to-select-trigger, .media-library-view .media-library-item .form-checkbox')\n        .forEach(trigger => {\n          trigger.addEventListener('click', () => {\n            const selectAll = document.querySelector('.media-library-select-all .form-boolean');\n            const checkboxes = document.querySelectorAll('.media-library-view .media-library-item .form-boolean');\n            const checkboxesChecked = document.querySelectorAll('.media-library-view .media-library-item .form-boolean:checked');\n\n            if (selectAll && selectAll.checked === true && checkboxes.length !== checkboxesChecked.length) {\n              selectAll.checked = false;\n              selectAll.dispatchEvent(new Event('change'));\n\n            } else if (checkboxes.length === Array.from(checkboxes).filter(el => el.checked === true).length) {\n              selectAll.checked = true;\n              selectAll.dispatchEvent(new Event('change'));\n            }\n\n            Drupal.neoMediaLibrary.bulkOperations();\n          });\n        });\n    },\n\n    bulkOperations: () => {\n      const bulkOperations = document.querySelector('.media-library-view [data-drupal-selector*=\"edit-header\"]');\n      const bulkOperationsStickyBar = document.querySelector('.media-library-views-form__bulk_form');\n\n      if (bulkOperations && document.querySelectorAll('.media-library-view .form-checkbox:checked').length > 0) {\n        bulkOperations.classList.add('is-sticky');\n        bulkOperationsStickyBar?.setAttribute('data-drupal-sticky-vbo', true);\n      } else {\n        bulkOperations.classList.remove('is-sticky');\n        bulkOperationsStickyBar?.setAttribute('data-drupal-sticky-vbo', false);\n      }\n    },\n\n  };\n})(Drupal, once);\n"],"names":["Drupal","once","el","header","selectAll","e","currentTarget","checkboxes","checkbox","announcement","trigger","checkboxesChecked","bulkOperations","bulkOperationsStickyBar"],"mappings":"CAAC,CAACA,GAAQC,MAAS;AACjB,EAAAD,EAAO,UAAU,kBAAkB;AAAA,IACjC,QAAQ,WAAkB;AACxB,MAAAA,EAAO,gBAAgB;IACxB;AAAA,EACL,GAEEA,EAAO,kBAAkB;AAAA,IACvB,MAAM,WAAY;AAChB,MAAAC,EAAK,4BAA4B,qDAAqD,EAAE,QAAQ,CAAAC,MAAM;AACpG,YAAIA,EAAG,iBAAiB,wBAAwB,EAAE,QAAQ;AACxD,gBAAMC,IAAS,SAAS,cAAc,2BAA2B,GAC3DC,IAAY,SAAS,cAAc,OAAO;AAChD,UAAAA,EAAU,YAAY,4BACtBA,EAAU,YAAYJ,EAAO,MAAM,UAAU,IAAIA,EAAO,EAAE,kBAAkB,GAC5EI,EAAU,SAAS,CAAC,EAAE,iBAAiB,SAAS,CAAAC,MAAK;AACnD,kBAAMC,IAAgBD,EAAE,eAClBE,IAAaD,EAChB,QAAQ,wBAAwB,EAChC,iBAAiB,sCAAsC;AAE1D,YAAAC,EAAW,QAAQ,CAAAC,MAAY;AAG7B,cAFqBA,EAAS,YAAYF,EAAc,YAGtDE,EAAS,UAAUF,EAAc,SACjCE,EAAS,cAAc,IAAI,MAAM,QAAQ,CAAC;AAAA,YAE1D,CAAa;AAED,kBAAMC,IAAeH,EAAc,UAAUN,EAAO,EAAE,6BAA6B;AAAA,cACjF,UAAUO,EAAW;AAAA,YACtB,CAAA,IAAIP,EAAO,EAAE,qBAAqB;AACnC,YAAAA,EAAO,SAASS,CAAY,GAE5B,KAAK,eAAc;AAAA,UAC/B,CAAW,GACDN,EAAO,QAAQC,CAAS;AAAA,QACzB;AAED,aAAK,WAAU;AAAA,MACvB,CAAO;AAAA,IACF;AAAA,IAED,YAAY,MAAM;AAChB,eAAS,iBAAiB,yGAAyG,EAChI,QAAQ,CAAAM,MAAW;AAClB,QAAAA,EAAQ,iBAAiB,SAAS,MAAM;AACtC,gBAAMN,IAAY,SAAS,cAAc,yCAAyC,GAC5EG,IAAa,SAAS,iBAAiB,uDAAuD,GAC9FI,IAAoB,SAAS,iBAAiB,+DAA+D;AAEnH,UAAIP,KAAaA,EAAU,YAAY,MAAQG,EAAW,WAAWI,EAAkB,UACrFP,EAAU,UAAU,IACpBA,EAAU,cAAc,IAAI,MAAM,QAAQ,CAAC,KAElCG,EAAW,WAAW,MAAM,KAAKA,CAAU,EAAE,OAAO,CAAAL,MAAMA,EAAG,YAAY,EAAI,EAAE,WACxFE,EAAU,UAAU,IACpBA,EAAU,cAAc,IAAI,MAAM,QAAQ,CAAC,IAG7CJ,EAAO,gBAAgB;QACnC,CAAW;AAAA,MACX,CAAS;AAAA,IACJ;AAAA,IAED,gBAAgB,MAAM;AACpB,YAAMY,IAAiB,SAAS,cAAc,2DAA2D,GACnGC,IAA0B,SAAS,cAAc,sCAAsC;AAE7F,MAAID,KAAkB,SAAS,iBAAiB,4CAA4C,EAAE,SAAS,KACrGA,EAAe,UAAU,IAAI,WAAW,GACxCC,KAAA,QAAAA,EAAyB,aAAa,0BAA0B,QAEhED,EAAe,UAAU,OAAO,WAAW,GAC3CC,KAAA,QAAAA,EAAyB,aAAa,0BAA0B;AAAA,IAEnE;AAAA,EAEL;AACA,GAAG,QAAQ,IAAI;"}